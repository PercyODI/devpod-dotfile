# Set prefix to Ctrl-a
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Enable mouse support
set -g mouse on

set -g default-command /bin/zsh

# set -g terminal-overrides ',xterm-256color:Tc'
# set -ga terminal-overrides ',*256col*:Tc'
#
# set-option -g default-terminal 'tmux-256color'
# set-option -sg escape-time 10
# set-option -g focus-events on
# set-option -a terminal-features 'tmux-256color:RGB'
# Set 256 color support
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
set-option -a terminal-features 'xterm:RGB'

set-option -sg escape-time 10
set-option -g focus-events on
# # Start windows and panes at 1, not 0
# set -g base-index 1
# setw -g pane-base-index 1

# # Don't renumber windows when one is closed
set -g renumber-windows off

# # Increase scrollback buffer size
# set -g history-limit 50000

# # Don't exit from tmux when closing a session
# set -g detach-on-destroy off

# # Use vim keybindings in copy mode
# setw -g mode-keys vi

# # Easier pane splitting with | and -
# bind | split-window -h -c "#{pane_current_path}"
# bind - split-window -v -c "#{pane_current_path}"
# unbind '"'
# unbind %

# # Easier pane navigation with vim-like keys
# bind h select-pane -L
# bind j select-pane -D
# bind k select-pane -U
# bind l select-pane -R

# # Easier pane resizing with Shift + vim-like keys
# bind -r H resize-pane -L 5
# bind -r J resize-pane -D 5
# bind -r K resize-pane -U 5
# bind -r L resize-pane -R 5

# # Reload config file with prefix + r
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Config reloaded!"

# # Enable focus events (useful for vim/neovim)
# set -g focus-events on

# # Reduce escape time (better for vim/neovim)
# set -sg escape-time 10

# # Status bar styling
# set -g status-style 'bg=#333333 fg=#5eacd3'
# set -g status-left-length 40
# set -g status-right-length 100
# set -g status-left '#[fg=#5eacd3,bold]  #S '
# set -g status-right '#[fg=#5eacd3] %Y-%m-%d %H:%M '

# # Window status styling
# set -g window-status-current-style 'fg=#ffffff,bold,bg=#5eacd3'
# set -g window-status-style 'fg=#aaaaaa'
# set -g window-status-format ' #I:#W '
# set -g window-status-current-format ' #I:#W '

# # Pane border styling
# set -g pane-border-style 'fg=#444444'
# set -g pane-active-border-style 'fg=#5eacd3'

# # Message styling
# set -g message-style 'bg=#5eacd3 fg=#000000 bold'

# # ============================================================================
# # Development Workspace Keybindings
# # ============================================================================
# # These keybindings are designed to work with the dev-workspace.sh layout
# # without conflicting with LazyVim (which uses Space as leader).
# #
# # The standard layout has 4 panes:
# #   Pane 0 (top-left):     Neovim editor (main workspace)
# #   Pane 1 (right-top):    Claude Code (AI assistant)
# #   Pane 2 (right-bottom): Test watcher
# #   Pane 3 (bottom):       Command/build terminal
# #
# # Quick pane navigation (no prefix needed):
# # Alt+h/j/k/l jumps directly to panes without needing Ctrl-a first
# # This is faster for frequent pane switching during development
# bind -n M-h select-pane -L
# bind -n M-j select-pane -D
# bind -n M-k select-pane -U
# bind -n M-l select-pane -R

# # Direct pane selection by number (prefix + number)
# # Useful for jumping to specific panes in the dev workspace
# bind 1 select-pane -t 1  # Jump to Neovim
# bind 2 select-pane -t 2  # Jump to Claude
# bind 3 select-pane -t 3  # Jump to Test watcher
# bind 4 select-pane -t 4  # Jump to Command terminal

# # Toggle pane zoom (prefix + z) - already built into tmux
# # This maximizes the current pane, hiding all others temporarily
# # Press again to restore the layout
# # Useful for: focusing on code, reading Claude's full response, or viewing test output

# # Panel toggle keybindings (prefix + Shift+Letter)
# # These use capital letters to avoid conflicts with default tmux commands
# #
# # How these work:
# # - Each binding runs a shell command that checks the pane's width/height
# # - If the pane is small (â‰¤5 units), it's considered "hidden" and gets restored
# # - If the pane is normal size, it gets shrunk to 1 unit (effectively hidden)
# # - This creates a toggle effect without actually killing/creating panes
# #
# # Why this approach:
# # - Preserves pane history and running processes (Claude session, test watchers)
# # - Faster than killing and respawning panes
# # - More intuitive than layout switching

# # Toggle Claude panel (right-top)
# # Ctrl-a + Shift+C
bind C if-shell \
  "[ $(tmux display-message -p -t :.1 '#{pane_width}') -le 5 ]" \
  "resize-pane -t :.1 -x 40" \
  "resize-pane -t :.1 -x 1"

# # Toggle Test panel (right-bottom)
# # Ctrl-a + Shift+T
# bind T if-shell \
#   "[ $(tmux display-message -p -t 3 '#{pane_height}') -le 5 ]" \
#   "resize-pane -t 3 -y 40%" \
#   "resize-pane -t 3 -y 1"

# # Toggle Bottom command panel
# # Ctrl-a + Shift+B
bind B if-shell \
  "[ $(tmux display-message -p -t :.2 '#{pane_height}') -le 5 ]" \
  "resize-pane -t :.2 -y 20%" \
  "resize-pane -t :.2 -y 1"

# # Restore default layout (prefix + Shift+R)
# # This resets all panes to their original sizes
# # Useful if you've hidden multiple panels and want to restore the full workspace
# bind R select-layout tiled \; \
#   resize-pane -t 1 -x 60% \; \
#   resize-pane -t 2 -x 40% \; \
#   resize-pane -t 3 -y 40% \; \
#   resize-pane -t 4 -y 20%

# # Quick layout: Focus mode (prefix + Shift+F)
# # Hides all side panels, leaving only Neovim and bottom command pane
# # Great for deep focus on coding
# bind F resize-pane -t 2 -x 1 \; resize-pane -t 3 -y 1

# # Quick layout: Review mode (prefix + Shift+V)
# # Shows Neovim + Claude side-by-side, hides test and bottom panels
# # Great for pair programming with Claude or reviewing AI suggestions
# bind V resize-pane -t 2 -x 40% \; resize-pane -t 3 -y 1 \; resize-pane -t 4 -y 1

# # ============================================================================
# # Why these keybindings don't conflict with LazyVim:
# # ============================================================================
# # 1. All bindings require the tmux prefix (Ctrl-a) first
# # 2. LazyVim uses Space or Ctrl-key combinations as its leader
# # 3. When you're focused in nvim, these tmux bindings won't trigger
# # 4. Alt-based navigation (M-h/j/k/l) works at tmux level, not passed to nvim
# # 5. Capital letters (C, T, B, R, F, V) are distinct from common tmux defaults
# #
# # Common LazyVim keybindings that WON'T conflict:
# # - Space + [key]: LazyVim leader commands (work inside nvim)
# # - Ctrl-w + [key]: Window navigation in nvim (work inside nvim)
# # - Ctrl-h/j/k/l: Navigate vim splits (work inside nvim)
# #
# # These tmux bindings operate at a higher level and only activate when you
# # press the tmux prefix (Ctrl-a) first.
